---
import DataCursos from "../data/GetDataCursos";
import Layout from "../layout/Layout.astro";
import MallaCurricular from "../sections/MallaCurricular.astro";
import Acordeon from "../components/Acordeon.astro";
import FormularioBanner from "../components/Formulario/FormularioBanner.astro";
import BannerNew from "../components/BannerNew.astro";
import PictureImg from "../components/PictureImg.astro";
import Typografic from "../components/Typografic.astro";

export async function getStaticPaths() {
    return DataCursos.map((curso) => {
        return {
            params: { curso: curso.id },
            props: curso,
        };
    });
}

const { descripcion, titulo, imagenes, modulos, imagenesBanner } = Astro.props;

const { original } = imagenes;
---

<Layout titulo={titulo} descripction={descripcion}>
    <link
        slot="preload"
        fetchpriority="high"
        rel="preload"
        as="image"
        href=`/img/${imagenesBanner.imagen}-small-lcpi.avif`
        media="(max-width: 640px)"
        type="image/webp"
    />
    <link
        slot="preload"
        fetchpriority="high"
        rel="preload"
        as="image"
        href=`/img/${imagenesBanner.imagen}-large-lcpi.avif`
        media="(min-width: 641px)"
        type="image/webp"
    />
    <BannerNew
        titulo={titulo}
        descripcion={descripcion}
        textoBoton="Más información"
        imagenesBanner={imagenesBanner}
        columnas={2}
    >
        <FormularioBanner slot="Columna2" />
    </BannerNew>
    <MallaCurricular>
        {
            modulos.map(({ id, semanas }, i) => {
                return (
                    <>
                        <Typografic
                            as="h3"
                            weigth="700"
                            variant="colorBlue"
                            style="padding-block: 1rem;"
                        >{`Modulo ${i + 1} : ${id}`}</Typografic>
                        {semanas.map((semana, index) => {
                            return (
                                <Acordeon
                                    numModulo={index + 1}
                                    modulo={id}
                                    semanas={semana.temas}
                                />
                            );
                        })}
                    </>
                );
            })
        }

        <PictureImg
            slot="Poster"
            class="Poster"
            {...original}
            aspectRatio="poster"
        />
    </MallaCurricular>
</Layout>

<style lang="scss">
    .Poster {
        grid-area: poster;
        align-self: start;
        position: sticky;
        top: var(--header-heigth);
        overflow: hidden;
        border-radius: 0.5rem;
    }
</style>
